sudo: required
dist: trusty
language: cpp
compiler: gcc

before_install:
    - sudo apt-get -qq update && sudo apt-get install -y --no-install-recommends texlive-fonts-recommended texlive-latex-extra texlive-fonts-extra dvipng texlive-latex-recommended latexmk texlive-lang-german texlive-doc-de pgf texlive-font-utils zip inkscape texlive-math-extra graphviz make libsfml-dev libgtest-dev cmake libgmp3-dev libboost-all-dev python3 sqlite3 
    - cd /usr/src/gtest
    - sudo cmake CMakeLists.txt
    - sudo make
    - sudo cp *.a /usr/lib
    - sudo ldconfig 
    - cd $TRAVIS_BUILD_DIR
    - git clone https://github.com/NASA-SW-VnV/ikos.git
    - cd ikos
    - mkdir build
    - cd build
    - cmake ..
    - make -j8
    - make install

addons:
    apt:
        sources:
        - ubuntu-toolchain-r-test
        packages:
        - gcc-7
        - g++-7
        - clang-7.0
        - llvm-7.0
        - cmake

script:
    - mkdir output
    - cd Blatt01
    - latexmk -pdf main.tex
    - mv main.pdf ../output/Blatt01.pdf
    - cd ..
    - cd Blatt02
    - make all
    - mv main.pdf ../output/Blatt02.pdf
    - cd ..
    - cd Blatt03
    - make all
    - mv main.pdf ../output/Blatt03.pdf
    - cd ..
    - cd Blatt04
    - make all
    - mv main.pdf ../output/Blatt04.pdf
    - cd ..
    - sudo ln -s /usr/bin/gcc-7 /usr/local/bin/gcc
    - sudo ln -s /usr/bin/g++-7 /usr/local/bin/g++
    - cd Blatt05
    - mkdir -p build
    - cd build
    - cmake ..
    - make all
    - ./Test
    - cd ..
    - ./../ikos main.cpp

deploy:
    provider: pages
    skip-cleanup: true
    github-token: $GITHUB_TOKEN  # Set in travis-ci.org dashboard, marked secure
    keep-history: true
    local-dir: output
    on:
        branch: master
